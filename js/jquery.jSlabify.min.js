/*! jQuery jSlabify plugin v1.0 MIT/GPL2 @gschoppe */
(function(e){e.fn.jSlabify=function(t){var n={targetFont:false,fontZoom:1,constrainHeight:false,slabRatio:1,fixedHeight:false,hCenter:false,vCenter:false,forceNewCharCount:true,wrapAmpersand:true,headerBreakpoint:null,viewportBreakpoint:null,noResizeEvent:false,resizeThrottleTime:300,maxFontSize:999,postTweak:true,precision:3,minCharsPerLine:0};e("body").addClass("slabified");return this.each(function(){if(t)e.extend(n,t);var r=e(this),i=e("span.slabbedtext",r).length,s=i?[]:String(e.trim(r.text())).replace(/\s{2,}/g," ").split(" "),o=null,u=null,a=n.targetFont,f=n.fontZoom,l=n.constrainHeight,c=n.slabRatio,h=n.fixedHeight,p=n.hCenter,d=n.vCenter,v=n.forceNewCharCount,m=n.headerBreakpoint,g=n.viewportBreakpoint,y=n.postTweak,b=n.precision,w=n.resizeThrottleTime,E=n.minCharsPerLine,S=null,x=e(window).width(),T=r.find("a:first").attr("href")||r.attr("href"),N=T?r.find("a:first").attr("title"):"";if(!i&&E&&s.join(" ").length<E)return;var C=function(){var e=s.join(" "),t=e.length,n=e.length>0?e:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-'.,?!&";dummy=jQuery('<div style="display:none;font-size:1em;margin:0;padding:0;height:auto;line-height:1;border:0;white-space:nowrap;">'+n+"</div>").appendTo(r),emW=dummy.width(),emH=dummy.height(),ratio=emH==0?1:emW/emH,charRatio=ratio/n.length;dummy.remove();return[emW,emH,ratio,n.length,charRatio]};var k=function(){var w=r.width(),S=h?r.height():w/c,k,L;r.removeClass("slabbedtextdone slabbedtextinactive");if(g&&g>x||m&&m>w){r.addClass("slabbedtextinactive");return}k=C();if(!i&&(v||L!=o)){o=k[1];if(a){var A=k[4],O=Math.min(60,Math.floor(w/(o*A*f)))}else{var M=k[3],_=k[2],D=w/S,P=Math.round(Math.sqrt(_/D)),O=Math.min(60,Math.max(Math.round(M/P),1))}var H=0,B=[],j=0,F="",I="",q="",R,U,z;if(O!=u){u=O;while(H<s.length){I="";while(I.length<u){F=I;I+=s[H]+" ";if(++H>=s.length){break}}if(E){R=s.slice(H).join(" ");if(R.length<E){I+=R;F=I;H=s.length+2}}U=u-F.length;z=I.length-u;if(U<z&&F.length>=(E||2)){q=F;H--}else{q=I}q=e("<div/>").text(q).html();if(n.wrapAmpersand)q=q.replace(/&/g,'<span class="amp">&</span>');q=e.trim(q);B.push('<span class="slabbedtext">'+q+"</span>")}r.html(B.join(" "));if(T)r.wrapInner('<a href="'+T+'" '+(N?'title="'+N+'" ':"")+"/>")}}else{o=k[1]}if(!(r.has("div.innerslabwrap").length>0)){r.wrapInner('<div class="innerslabwrap" />')}var W=r.children("div.innerslabwrap");W.css("font-size",1+"em");e("span.slabbedtext",r).each(function(){var t=e(this),r=t.text(),i=r.split(" ").length>1,s,u,a;if(y)t.css({"word-spacing":0,"letter-spacing":0});t.css("font-size",1+"em");u=w/t.width();a=(Math.min(o*u,n.maxFontSize)/o).toFixed(b);t.css("font-size",a+"em");s=!!y?w-t.width():false;if(s)t.css((i?"word":"letter")+"-spacing",(s/(i?r.split(" ").length-1:r.length)).toFixed(b)+"px")});var X=1;if(l&&W.height()>S){X=(S/W.height()).toFixed(b);W.css("font-size",X+"em")}if(l&&d){var V=((S-W.height())/2).toFixed(b);W.css("position","relative").css("top",V+"px")}if(p)W.css("text-align","center");r.addClass("slabbedtextdone")};k();if(!n.noResizeEvent){e(window).resize(function(){if(e(window).width()==x)return;x=e(window).width();clearTimeout(S);S=setTimeout(k,w)})}})}})(jQuery)