/*! jQuery jSlabify plugin v1.0 MIT/GPL2 @gschoppe */
(function(e){e.fn.jSlabify=function(t){var n={fontRatio:.472,boxRatio:1,fixedHeight:false,borderBox:false,forceNewCharCount:true,wrapAmpersand:true,headerBreakpoint:null,viewportBreakpoint:null,noResizeEvent:false,resizeThrottleTime:300,maxFontSize:999,postTweak:true,precision:3,minCharsPerLine:0};e("body").addClass("slabtexted");return this.each(function(){if(t){e.extend(n,t)}var r=e(this),i=e("span.slabtext",r).length,s=i?[]:String(e.trim(r.text())).replace(/\s{2,}/g," ").split(" "),o=null,u=null,a=n.fontRatio,f=n.boxRatio,l=n.fixedHeight,c=n.borderBox,h=n.forceNewCharCount,p=n.headerBreakpoint,d=n.viewportBreakpoint,v=n.postTweak,m=n.precision,g=n.resizeThrottleTime,y=n.minCharsPerLine,b=null,w=e(window).width(),E=r.find("a:first").attr("href")||r.attr("href"),S=E?r.find("a:first").attr("title"):"";if(!i&&y&&s.join(" ").length<y){return}var x=function(){var e=jQuery('<div style="display:none;font-size:1em;margin:0;padding:0;height:auto;line-height:1;border:0;"> </div>').appendTo(r),t=e.height();e.remove();return t};var T=function(){var f=r.width(),g=l?r.height():f/C,b;r.removeClass("slabtextdone slabtextinactive");if(d&&d>w||p&&p>f){r.addClass("slabtextinactive");return}b=x();if(!i&&(h||b!=o)){o=b;var T=s.join(" ").length,N=T*a,C=f/g,k=Math.round(Math.sqrt(N/C)),L=Math.min(60,Math.max(Math.round(T/k),1)),A=0,O=[],M=0,_="",D="",P="",H,B,j;if(L!=u){u=L;while(A<s.length){D="";while(D.length<u){_=D;D+=s[A]+" ";if(++A>=s.length){break}}if(y){H=s.slice(A).join(" ");if(H.length<y){D+=H;_=D;A=s.length+2}}B=u-_.length;j=D.length-u;if(B<j&&_.length>=(y||2)){P=_;A--}else{P=D}P=e("<div/>").text(P).html();if(n.wrapAmpersand){P=P.replace(/&/g,'<span class="amp">&</span>')}P=e.trim(P);O.push('<span class="slabtext">'+P+"</span>")}r.html(O.join(" "));if(E){r.wrapInner('<a href="'+E+'" '+(S?'title="'+S+'" ':"")+"/>")}}}else{o=b}var F=0;e("span.slabtext",r).each(function(){var t=e(this),i=t.text(),s=i.split(" ").length>1,u,a,l;if(v){t.css({"word-spacing":0,"letter-spacing":0})}r.css("font-size",1+"em");t.css("font-size",1+"em");a=f/t.width();var c=(Math.min(o*a,n.maxFontSize)/o).toFixed(m);t.css("font-size",c+"em");F+=t.height();u=!!v?f-t.width():false;if(u){t.css((s?"word":"letter")+"-spacing",(u/(s?i.split(" ").length-1:i.length)).toFixed(m)+"px")}});var I=1;if(F>g){I=(g/F).toFixed(m);r.css("font-size",I+"em")}if(c)r.css("padding",(g-F*I)/2+"px 0");r.addClass("slabtextdone")};T();if(!n.noResizeEvent){e(window).resize(function(){if(e(window).width()==w){return}w=e(window).width();clearTimeout(b);b=setTimeout(T,g)})}})}})(jQuery)