/*! jQuery jSlabify plugin v1.0 MIT/GPL2 @gschoppe */
(function(e){e.fn.jSlabify=function(t){var n={targetFont:false,fontZoom:1,boxRatio:1,fixedHeight:false,borderBox:false,forceNewCharCount:true,wrapAmpersand:true,headerBreakpoint:null,viewportBreakpoint:null,noResizeEvent:false,resizeThrottleTime:300,maxFontSize:999,postTweak:true,precision:3,minCharsPerLine:0};e("body").addClass("slabtexted");return this.each(function(){if(t){e.extend(n,t)}var r=e(this),i=e("span.slabtext",r).length,s=i?[]:String(e.trim(r.text())).replace(/\s{2,}/g," ").split(" "),o=null,u=null,a=n.targetFont,f=n.fontZoom,l=n.boxRatio,c=n.fixedHeight,h=n.borderBox,p=n.forceNewCharCount,d=n.headerBreakpoint,v=n.viewportBreakpoint,m=n.postTweak,g=n.precision,y=n.resizeThrottleTime,b=n.minCharsPerLine,w=null,E=e(window).width(),S=r.find("a:first").attr("href")||r.attr("href"),x=S?r.find("a:first").attr("title"):"";if(!i&&b&&s.join(" ").length<b){return}var T=function(){var e=s.join(" "),t=e.length,n=e.length>0?e:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-'.,?!&";dummy=jQuery('<div style="display:none;font-size:1em;margin:0;padding:0;height:auto;line-height:1;border:0;white-space:nowrap;">'+n+"</div>").appendTo(r),emW=dummy.width(),emH=dummy.height(),ratio=emH==0?1:emW/emH,charRatio=ratio/n.length;dummy.remove();return[emW,emH,ratio,n.length,charRatio]};var N=function(){var l=r.width(),y=c?r.height():l/O,w,N;r.removeClass("slabtextdone slabtextinactive");if(v&&v>E||d&&d>l){r.addClass("slabtextinactive");return}w=T();if(!i&&(p||N!=o)){o=w[1];if(a){var C=w[4],k=Math.min(60,Math.floor(l/(o*C*f)))}else{var L=w[3],A=w[2],O=l/y,M=Math.round(Math.sqrt(A/O)),k=Math.min(60,Math.max(Math.round(L/M),1))}var _=0,D=[],P=0,H="",B="",j="",F,I,q;if(k!=u){u=k;while(_<s.length){B="";while(B.length<u){H=B;B+=s[_]+" ";if(++_>=s.length){break}}if(b){F=s.slice(_).join(" ");if(F.length<b){B+=F;H=B;_=s.length+2}}I=u-H.length;q=B.length-u;if(I<q&&H.length>=(b||2)){j=H;_--}else{j=B}j=e("<div/>").text(j).html();if(n.wrapAmpersand){j=j.replace(/&/g,'<span class="amp">&</span>')}j=e.trim(j);D.push('<span class="slabtext">'+j+"</span>")}r.html(D.join(" "));if(S){r.wrapInner('<a href="'+S+'" '+(x?'title="'+x+'" ':"")+"/>")}}}else{o=w[1]}var R=0;r.css("padding",0);e("span.slabtext",r).each(function(){var t=e(this),i=t.text(),s=i.split(" ").length>1,u,a,f;if(m){t.css({"word-spacing":0,"letter-spacing":0})}r.css("font-size",1+"em");t.css("font-size",1+"em");a=l/t.width();f=(Math.min(o*a,n.maxFontSize)/o).toFixed(g);t.css("font-size",f+"em");R+=t.height();u=!!m?l-t.width():false;if(u){t.css((s?"word":"letter")+"-spacing",(u/(s?i.split(" ").length-1:i.length)).toFixed(g)+"px")}});var U=1;if(!a&&R>y){U=(y/R).toFixed(g);r.css("font-size",U+"em")}if(!a&&h)r.css("padding",(y-R*U)/2+"px 0");r.addClass("slabtextdone")};N();if(!n.noResizeEvent){e(window).resize(function(){if(e(window).width()==E){return}E=e(window).width();clearTimeout(w);w=setTimeout(N,y)})}})}})(jQuery)